<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Combined Loading + Video + Flappy Bird + Cat Generator + Bouncing Text</title>
  <style>
    /* === General styles === */
    html, body {
      height: 100%;
      margin: 0;
      background: #373636;
      color: #fff;
      font-family: Arial, sans-serif;
      overflow-x: hidden;
      position: relative;
    }
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }

    /* === Loading Bar Styles === */
    .loading-bar {
      display: flex;
      gap: 6px;
      justify-content: center;
      width: 100%;
      max-width: 520px;
      margin: 18px auto 12px;
      z-index: 60;
      position: relative;
    }
    .segment {
      width: 20px;
      height: 20px;
      border-radius: 4px;
      background: #333;
      transition: background 0.35s ease;
      box-sizing: border-box;
    }
    .segment.filled {
      background: rgb(123, 124, 123);
    }
    #loadingText {
      font-size: 16px;
      margin-top: 8px;
      color: #1bebd6;
      opacity: 1;
      transition: opacity 0.45s ease;
      text-align: center;
      min-height: 22px;
      user-select: none;
      z-index: 60;
      position: relative;
    }

    /* === Skip Button (runaway) === */
    #skipBtn {
      position: fixed;
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      height: 44px;
      padding: 0;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      box-sizing: border-box;
      background: #392c2c;
      color: #fff;
      font-weight: 600;
      font-size: 15px;
      border: 0;
      border-radius: 8px;
      cursor: pointer;
      transition: left 0.22s ease, top 0.22s ease;
      z-index: 100;
    }
    @media (max-width: 420px) {
      #skipBtn {
        width: 100px;
        height: 40px;
        font-size: 14px;
      }
      .loading-bar {
        gap: 4px;
      }
      .segment {
        width: 18px;
        height: 18px;
      }
    }

    /* === Video container with 9:16 aspect ratio === */
    .video-container {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
    }
    .video-container video {
      height: 80vh;
      width: calc(80vh * 9 / 16);
      border-radius: 12px;
      object-fit: cover;
      display: block;
    }

    /* === Flappy Bird Container === */
    #flappyContainer {
      position: fixed;
      left: 20px;
      top: 200px;
      display: flex;
      flex-direction: column;
      align-items: center;
      z-index: 50;
    }
    #flappyCanvas {
      background: skyblue;
      display: none;
      border-radius: 8px;
      box-shadow: 0 0 8px #222;
    }
    #startFlappy {
      margin-bottom: 10px;
      padding: 5px 15px;
      background: orange;
      border: none;
      cursor: pointer;
      border-radius: 6px;
      font-weight: bold;
      color: #111;
    }

    /* === Right Button (Clicks) === */
    #rightBtn {
      position: fixed;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      padding: 10px 20px;
      background: teal;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      color: white;
      font-weight: bold;
      z-index: 50;
      user-select: none;
    }

    /* === Cat Image Box === */
    #catBox {
      position: fixed;
      bottom: 10px;
      left: 10px;
      width: 100px;
      height: 100px;
      border: 2px solid #fff;
      overflow: hidden;
      border-radius: 8px;
      box-shadow: 0 0 8px #302e2e;
      z-index: 50;
    }
    #catBox img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      user-select: none;
    }

    /* === Floating text that bounces === */
    #floatingText {
      position: fixed;
      top: 50px;
      left: 50px;
      font-size: 24px;
      font-weight: bold;
      color: #590bc6;
      user-select: none;
      pointer-events: none;
      z-index: 150;
      white-space: nowrap;
      text-shadow: 1px 1px 2px rgb(25, 97, 222);
    }
  </style>
</head>
<body>

  <!-- Video -->
  <div class="video-container">
    <video src="file:///C:/Users/tvabi/Downloads/New%20folder/videoplayback%20(1).mp4" autoplay loop muted playsinline></video>
  </div>

  <!-- Loading Bar + Text -->
  <div class="loading-bar" id="loadingBar"></div>
  <div id="loadingText">Almost there...</div>

  <!-- Skip Button -->
  <button id="skipBtn" aria-label="Skip">Skip</button>

  <!-- Flappy Bird -->
  <div id="flappyContainer">
    <button id="startFlappy">Start Flappy Bird</button>
    <canvas id="flappyCanvas" width="200" height="300"></canvas>
  </div>

  <!-- Right side clicks button -->
  <button id="rightBtn">Clicks: 0</button>

  <!-- Cat Box -->
  <div id="catBox"></div>

  <!-- Floating bouncing text -->
  <div id="floatingText">LOADING...</div>

  <script>
    /* ===== Loading bar + messages ===== */
    const loadingBar = document.getElementById('loadingBar');
    const loadingText = document.getElementById('loadingText');
    const messages = [
      "Almost there",
      "Wait a minute",
      "Getting close",
      "We are nowhere there",
      "Lost all hope",
      "Do not give up"
    ];

    // Create 10 segments
    for(let i = 0; i < 10; i++) {
      const seg = document.createElement('div');
      seg.className = 'segment';
      loadingBar.appendChild(seg);
    }
    const segments = document.querySelectorAll('.segment');

    let segIndex = 0;
    let messageIndex = 0;
    function fillNextSegment() {
      if (segIndex < segments.length) {
        segments[segIndex].classList.add('filled');
        segIndex++;

        if (segIndex % 5 === 0) {
          loadingText.style.opacity = 0;
          setTimeout(() => {
            loadingText.textContent = messages[messageIndex];
            loadingText.style.opacity = 1;
            messageIndex = (messageIndex + 1) % messages.length;
          }, 450);
        }

        if (segIndex >= segments.length) {
          setTimeout(() => {
            segments.forEach(s => s.classList.remove('filled'));
            segIndex = 0;
          }, 500);
        }
      }
    }
    const FILL_INTERVAL = 800;
    let fillTimer = setInterval(fillNextSegment, FILL_INTERVAL);

    /* ===== Skip button: jumps + runs away ===== */
    const skipBtn = document.getElementById('skipBtn');
    let lastMove = 0;
    const MOVE_COOLDOWN_MS = 220;
    const AVOID_DISTANCE = 110;

    function moveSkipRandom() {
      const now = Date.now();
      if (now - lastMove < MOVE_COOLDOWN_MS) return;
      lastMove = now;

      const btnW = skipBtn.offsetWidth;
      const btnH = skipBtn.offsetHeight;
      const margin = 8;

      const maxX = Math.max(0, window.innerWidth - btnW - margin);
      const maxY = Math.max(0, window.innerHeight - btnH - margin);

      const randX = Math.floor(Math.random() * maxX) + margin;
      const randY = Math.floor(Math.random() * maxY) + margin;

      // Jump animation
      skipBtn.animate(
        [
          { transform: 'translateY(0)' },
          { transform: 'translateY(-15px)' },
          { transform: 'translateY(0)' }
        ],
        {
          duration: 200,
          easing: 'ease-out'
        }
      );

      // Move after jump ends
      setTimeout(() => {
        skipBtn.style.transform = 'none';
        skipBtn.style.left = randX + 'px';
        skipBtn.style.top = randY + 'px';
        skipBtn.style.bottom = 'auto';
      }, 200);
    }

    window.addEventListener('touchstart', () => {
      moveSkipRandom();
    }, { passive:true });

    document.addEventListener('mousemove', (e) => {
      const rect = skipBtn.getBoundingClientRect();
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;
      const dx = e.clientX - centerX;
      const dy = e.clientY - centerY;
      const dist = Math.hypot(dx, dy);

      if (dist < AVOID_DISTANCE) moveSkipRandom();
    });

    skipBtn.addEventListener('click', () => {
      clearInterval(fillTimer);
      alert('Skipped!');
    });

    window.addEventListener('resize', () => {
      const rect = skipBtn.getBoundingClientRect();
      const maxX = window.innerWidth - rect.width - 8;
      const maxY = window.innerHeight - rect.height - 8;
      if (rect.left > maxX) skipBtn.style.left = Math.max(8, maxX) + 'px';
      if (rect.top > maxY) skipBtn.style.top = Math.max(8, maxY) + 'px';
    });

    /* ===== Cat images + Right button logic ===== */
    const catImages = [
      "https://placekitten.com/100/100",
      "https://placekitten.com/101/100",
      "https://placekitten.com/102/100"
    ];
    const catBox = document.getElementById('catBox');

    let clickCount = 0;
    let flappyMode = false;
    const rightBtn = document.getElementById('rightBtn');

    rightBtn.addEventListener('click', () => {
      if (!flappyMode) {
        clickCount++;
        rightBtn.textContent = "Clicks: " + clickCount;
        // Show random cat image
        const randomCat = catImages[Math.floor(Math.random() * catImages.length)];
        catBox.innerHTML = `<img src="${randomCat}" alt="Cat Image">`;
      } else {
        // In flappy mode: flap bird
        birdVelocity = -5;
      }
    });

    /* ===== Flappy Bird game ===== */
    const canvas = document.getElementById('flappyCanvas');
    const ctx = canvas.getContext('2d');
    let birdY, birdVelocity, pipes, score, gameLoop;

    function startFlappyGame() {
      birdY = 150;
      birdVelocity = 0;
      pipes = [];
      score = 0;
      canvas.style.display = "block";
      gameLoop = setInterval(updateFlappy, 20);
    }

    function stopFlappyGame() {
      clearInterval(gameLoop);
      canvas.style.display = "none";
    }

    function updateFlappy() {
      birdVelocity += 0.2;
      birdY += birdVelocity;

      // Add pipes if none or last pipe passed threshold
      if (pipes.length === 0 || pipes[pipes.length - 1].x < 120) {
        const gapY = Math.random() * 150 + 50;
        pipes.push({ x: 200, gapY });
      }
      // Move pipes left
      pipes.forEach(p => p.x -= 2);

      // Check collision & update score
      pipes.forEach(p => {
        if (p.x < 20 && p.x > 0) score++;
        // Bird collision detection with pipes
        if (
          10 < p.x + 20 && 30 > p.x &&
          (birdY < p.gapY - 40 || birdY > p.gapY + 40)
        ) {
          stopFlappyGame();
          alert("Game Over! Score: " + score);
          flappyMode = false;
          rightBtn.textContent = "Clicks: " + clickCount;
        }
      });

      // Clear canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw bird (yellow square)
      ctx.fillStyle = "yellow";
      ctx.fillRect(10, birdY, 20, 20);

      // Draw pipes (green rectangles)
      ctx.fillStyle = "green";
      pipes.forEach(p => {
        ctx.fillRect(p.x, 0, 20, p.gapY - 40);
        ctx.fillRect(p.x, p.gapY + 40, 20, canvas.height - p.gapY - 40);
      });
    }

    /* Start/Stop Flappy Button */
    const startFlappyBtn = document.getElementById('startFlappy');
    startFlappyBtn.addEventListener('click', () => {
      if (!flappyMode) {
        flappyMode = true;
        clickCount = 0;
        rightBtn.textContent = "Flap!";
        startFlappyGame();
      } else {
        flappyMode = false;
        stopFlappyGame();
        rightBtn.textContent = "Clicks: " + clickCount;
      }
    });

    /* ===== Floating bouncing text logic ===== */
    const floatingText = document.getElementById('floatingText');
    let posX = 50;
    let posY = 50;
    let velocityX = 2; // px per frame
    let velocityY = 2;
    const textRect = floatingText.getBoundingClientRect();

    function animateFloatingText() {
      const maxX = window.innerWidth - floatingText.offsetWidth;
      const maxY = window.innerHeight - floatingText.offsetHeight;

      posX += velocityX;
      posY += velocityY;

      // Bounce off walls
      if (posX <= 0 || posX >= maxX) velocityX = -velocityX;
      if (posY <= 0 || posY >= maxY) velocityY = -velocityY;

      floatingText.style.left = posX + "px";
      floatingText.style.top = posY + "px";

      requestAnimationFrame(animateFloatingText);
    }
    animateFloatingText();

    // Also update bounding rect on resize to keep smooth bouncing
    window.addEventListener('resize', () => {
      // no special action needed, maxX and maxY computed dynamically each frame
    });
  </script>

</body>
</html>
